webpackJsonp([18],{"6LZU":function(t,i,e){var o=e("VU/8")(e("hSHd"),e("JT9d"),function(t){e("r/ch")},"data-v-b8277832",null);t.exports=o.exports},JT9d:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"container-box"},[e("el-dialog",{attrs:{title:"带看地图轨迹",visible:t.centerDialogVisible,width:"80%","before-close":t.handleClose,center:""},on:{"update:visible":function(i){t.centerDialogVisible=i}}},[e("div",{staticClass:"tab-box"},[e("div",{staticClass:"topbox"},[t._v("\n          请选择带看轨迹\n        ")]),t._v(" "),e("div",{staticClass:"map-liner"},t._l(t.lookRecordList,function(i,o){return e("div",{key:o,staticClass:"liner-item",class:{active:t.chooseActive===o},on:{click:function(e){t.chooseLiner(i,o)}}},[e("div",{staticClass:"liner-nuim"},[e("span",{staticClass:"text"},[t._v("\n                 带看"+t._s(o+1)+"\n               ")]),t._v(" "),e("span",{staticClass:"room-num"},[t._v("带看"+t._s(i.roomCount)+"间房")])]),t._v(" "),e("div",{staticClass:"time-all"},[e("div",{staticClass:"time"},[e("span",{staticClass:"start-time"},[t._v("\n                  "+t._s(i.startDate)+"\n                 ")]),t._v(" "),e("span",{staticClass:"room-num"},[t._v("开始带看")])]),t._v(" "),e("div",{staticClass:"time"},[e("span",{staticClass:"start-time"},[t._v("\n                  "+t._s(i.endDate)+"\n                 ")]),t._v(" "),e("span",{staticClass:"room-num"},[t._v("结束带看")])])])])}))]),t._v(" "),e("div",{staticStyle:{width:"100%"},attrs:{id:"map"}}),t._v(" "),e("div",{staticClass:"block"},[e("span",{staticClass:"demonstration"},[t._v("开始")]),t._v(" "),e("el-slider",{staticClass:"blockSlide",attrs:{max:t.lineList.length,"format-tooltip":t.formatTooltip},model:{value:t.lineValue,callback:function(i){t.lineValue=i},expression:"lineValue"}}),t._v(" "),e("span",{staticClass:"demonstration"},[t._v("结束")])],1)])],1)},staticRenderFns:[]}},gFaY:function(t,i,e){(t.exports=e("FZ+f")(!1)).push([t.i,".block[data-v-b8277832]{position:absolute;bottom:90px;display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;width:400px;right:40px;border-radius:10px;padding:0 20px;background:#fff;z-index:10}.block .demonstration[data-v-b8277832]{width:40px;text-align:center;line-height:38px;font-size:10px}.block .blockSlide[data-v-b8277832]{-ms-flex:1;flex:1;-webkit-box-flex:1}.tab-box[data-v-b8277832]{position:absolute;top:90px;z-index:10;width:220px;left:60px;-webkit-box-shadow:4px 4px 5px #888;box-shadow:4px 4px 5px #888}.tab-box .map-liner[data-v-b8277832]{background:#fff;height:440px;padding-bottom:4px;overflow:auto}.tab-box .active[data-v-b8277832]{background:#909399!important}.tab-box .topbox[data-v-b8277832]{overflow:hidden;text-align:center;height:45px;line-height:45px;color:#fff;background:#409eff}.tab-box .liner-item[data-v-b8277832]{background:#c7c7c7;color:#fff;padding:0 10px;margin-bottom:10px}.tab-box .liner-item .liner-nuim[data-v-b8277832]{height:35px;line-height:35px;border-bottom:2px solid #fff}.tab-box .liner-item .time[data-v-b8277832]{line-height:26px}.tab-box .liner-item .room-num[data-v-b8277832]{float:right}.button-group[data-v-b8277832]{position:absolute;bottom:40px;z-index:9999;right:0}#map[data-v-b8277832]{height:540px;padding:0;width:100%;background:#fff}#container[data-v-b8277832]{width:100%;height:100%;font-size:15px}#panel[data-v-b8277832]{background-color:#fff;max-height:90%;overflow-y:auto;top:10px;right:10px;width:280px;border-bottom:1px solid silver}.footer_map_buttons[data-v-b8277832]{background:#fff;width:100%;font-size:0}.footer_map_buttons button[data-v-b8277832]{font-size:15px;background:#fff;border:none;width:24%;display:inline-block;line-height:40px}.footer_map_buttons .enroll[data-v-b8277832]{display:inline-block;width:28%;background:#fe4a4a;color:#fff}.footer_map_buttons .active[data-v-b8277832]{color:#fe4a4a}.content[data-v-b8277832]{position:absolute;background:#fff;left:0;top:0;width:100%;height:40%;visibility:hidden;z-index:9999}.content>.content-top[data-v-b8277832]{height:84%;overflow:hidden}.content>.content-top>div[data-v-b8277832]{font-size:12px;line-height:.7rem;border-bottom:1px solid #aeaeae;margin:0 5%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.content>.content-bottom[data-v-b8277832]{height:10%;text-align:center;font-weight:300;color:#333;font-size:30px}.input[data-v-b8277832]{position:absolute;top:20px;z-index:10;right:40px}.list-button[data-v-b8277832]{font-size:12px;position:absolute;background:#fff;left:1%;bottom:8%;width:20%;padding:2% 0;height:6%;z-index:200}.list-button>div[data-v-b8277832]{text-align:center}",""])},hSHd:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=e("mtWM"),a=e.n(o),n=e("0xDb"),s=e("Htgu"),l=void 0,r=void 0;i.default={components:{},mounted:function(){},data:function(){return{centerDialogVisible:!1,lookRecordList:[],chooseActive:0,lineList:[],lineValue:0,nowLiner:[],oldvalue:0,lineArr:[]}},watch:{lineValue:function(t,i){var e=[];e=t>i?this.lineArr.slice(i,t):this.lineArr.slice(t,i).reverse(),r.moveAlong(e,9e4,function(){})}},methods:{formatTooltip:function(t){if(this.lineList.length>0)return Object(n.d)(this.lineList[t].locatetime)},handleClose:function(){this.centerDialogVisible=!1,r=""},getAmapLinerShow:function(t){var i=this;this.centerDialogVisible=!0,this.chooseActive=0,this.lineValue=0,this.$nextTick(function(){Object(s.a)({customerId:t}).then(function(t){i.lookRecordList=t.data,i.getLineArr(i.lookRecordList)})})},chooseLiner:function(t,i){this.chooseActive=i,this.lineValue=0,this.nowLiner=[],l.destroy(),this.getLineArr()},addClickHandler:function(t,i){i.on("mouseover",function(t){t.target.info.open(l,t.target.getPosition())})},init:function(){var t=this,i=this.lineList[0].location.split(",");l=this.lineList.length>0?new AMap.Map("map",{resizeEnable:!0,zoom:12,center:[i[0],i[1]]}):new AMap.Map("map",{resizeEnable:!0,zoom:12}),this.lookRecordList[this.chooseActive].allocationInfoDTOs.map(function(i){var e=new AMap.Marker({map:l,icon:new AMap.Icon({image:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",imageSize:new AMap.Size(24,24)}),offset:new AMap.Pixel(0,0),position:[i.lookLongitude,i.lookLatitude]});e.info=new AMap.InfoWindow({content:"<div class=\"content-amap\">\n                          <div class='info'>房间地点："+i.roomName+"("+i.roomCode+")</div>\n                          <div class='info'>带看时间："+i.lookTime+"</div>\n                          </div>",offset:new AMap.Pixel(0,0)}),t.addClickHandler(i,e)}),r=new AMap.Marker({map:l,icon:"https://webapi.amap.com/images/car.png",offset:new AMap.Pixel(-26,-13),position:[i[0],i[1]],autoRotation:!0}),l.plugin(["AMap.ToolBar","AMap.MapType"],function(){var t={offset:new AMap.Pixel(70,10),position:"RT",ruler:!0,noIpLocate:!1,locate:!0,liteStyle:!1,direction:!0,autoPosition:!0,locationMarker:AMap.Marker({map:l}),useNative:!1};l.addControl(new AMap.ToolBar(t)),l.addControl(new AMap.MapType({showTraffic:!1,showRoad:!1}))})},handleLogin:function(){this.getLineArr()},drawLine:function(){var t=this;this.lineArr=[],this.lineList.map(function(i){var e=i.location.split(",");t.lineArr.push(new AMap.LngLat(e[0],e[1]))}),new AMap.Polyline({map:l,path:this.lineArr,strokeColor:"#fe4a4a",strokeOpacity:1,strokeWeight:6,strokeStyle:"solid"});var i=new AMap.Polyline({map:l,path:this.lineArr,strokeColor:"#000",strokeOpacity:1,strokeWeight:6,strokeStyle:"solid"});r.on("moving",function(t){i.setPath(t.passedPath)}),l.setFitView()},getLineArr:function(){var t=this;console.log(this.lookRecordList);var i={starttime:this.lookRecordList[this.chooseActive].startTime,endtime:this.lookRecordList[this.chooseActive].endTime,page:1,gap:1e3,pagesize:800,tid:this.lookRecordList[this.chooseActive].gdTid,sid:11117,trid:this.lookRecordList[this.chooseActive].trid},e=this;a.a.get("https://tsapi.amap.com/v1/track/terminal/trsearch?key=7bf2aa112f46d78281004b9f678e03f2",{params:i}).then(function(i){1e4===i.data.errcode?e.lineList=i.data.data.tracks[0].points:t.$message({message:i.data.errdetail}),t.init(),e.drawLine()})}}}},"r/ch":function(t,i,e){var o=e("gFaY");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);e("rjj0")("149a3bb0",o,!0)}});