webpackJsonp([2,14,16],{"+OQD":function(e,t,a){var i=a("LKJ5");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("a89534c2",i,!0)},"/sDd":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"container"},[a("el-container",[a("el-aside",{staticClass:"leftSidebar",attrs:{width:"260px"}},[a("el-form",[a("el-form-item",[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.searchFrom.depName,callback:function(t){e.$set(e.searchFrom,"depName",t)},expression:"searchFrom.depName"}},[a("el-tree",{ref:"overlayTree",attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","highlight-current":!0,"expand-on-click-node":!1},on:{getManagerId:e.nowManagerId,"node-click":e.overlayNodeClick}}),e._v(" "),a("el-option",{staticStyle:{display:"none"},attrs:{value:""}})],1)],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{size:"small",placeholder:"业务员姓名/手机号码"},on:{input:e.searchIsDeleteList},model:{value:e.searchFrom.keyword,callback:function(t){e.$set(e.searchFrom,"keyword",t)},expression:"searchFrom.keyword"}})],1),e._v(" "),a("el-form-item",[a("div",{staticClass:"table-box"},[a("scrollLoad",{attrs:{listHeight:e.listHeight,butlerList:e.butlerList,chooseIndex:e.chooseIndex,getBulter:e.getisDeleteList},on:{getManagerId:e.nowManagerId}})],1)])],1)],1),e._v(" "),a("el-main",{staticClass:"pageMain"},[a("div",{staticClass:"showbox"},[e._v("\n        当前工作人数："+e._s(e.countDate)+"\n      ")]),e._v(" "),a("div",{style:e.mapHeight,attrs:{id:"map"}})])],1)],1)},staticRenderFns:[]}},"43mw":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("+MD4"),o=a("Htgu"),n=a("+aT9"),s=a.n(n),r=a("vqyU"),l=a.n(r),d=void 0;t.default={components:{ScrollLoad:l.a},computed:{listHeight:function(){return{height:this.tableHeight-49+"px"}},mapHeight:function(){return{height:this.tableHeight+28+"px"}}},data:function(){return{countDate:"",butlerList:[],pageNumber:0,chooseIndex:"",treeData:[],loading:!0,defaultProps:{children:"child",label:"depName"},IncumbencyList:[{value:null,label:"全部"},{value:0,label:"在职"},{value:1,label:"离职"}],searchFrom:{depId:"",isDelete:"",keyword:"",startTime:"",endTime:"",roomName:"",managerId:""}}},mounted:function(){this.getTree()},created:function(){var e=this,t=document.body.clientHeight-250;this.tableHeight=t>300?t:300,window.onresize=function(){return t=document.body.clientHeight-250,void(e.tableHeight=t>300?t:300)}},methods:{nowManagerId:function(e,t){if(this.searchFrom.managerId=e.id,this.chooseIndex=t,""!==e.data.location){d.setZoomAndCenter(14,e.data.location.split(","));var a=new s.a.Marker({map:d,icon:new s.a.Icon({image:!0===e.status?"//webapi.amap.com/theme/v1.2/m3.png":"//webapi.amap.com/theme/v1.2/m1.png",imageSize:new s.a.Size(24,24)}),offset:new s.a.Pixel(-26,-13),position:e.data.location.split(",")});a.info=new s.a.InfoWindow({content:"<div class=\"content-amap\">\n                       <div class='info'>"+e.name+"</div>\n                       <div class='info'>工作状态："+(!0===e.status?"工作中":"休息")+"</div>\n                       <div class='info'>时间："+e.data.locatetime+"</div>\n                      </div>",offset:new s.a.Pixel(0,0)}),a.info.open(d,e.data.location.split(",")),this.addClickHandler(e,a)}},addClickHandler:function(e,t){t.on("mouseover",function(e){e.target.info.open(d,e.target.getPosition())})},init:function(){var e=this;d=new s.a.Map("map",{resizeEnable:!0,zoom:12}),this.butlerList.map(function(t){if(""!==t.data.location){var a=new s.a.Marker({map:d,icon:new s.a.Icon({image:!0===t.status?"//webapi.amap.com/theme/v1.2/m3.png":"//webapi.amap.com/theme/v1.2/m1.png",imageSize:new s.a.Size(24,24)}),offset:new s.a.Pixel(-26,-13),position:t.data.location.split(",")});a.info=new s.a.InfoWindow({content:"<div class=\"content-amap\">\n                       <div class='info'>"+t.name+"</div>\n                       <div class='info'>工作状态："+(!0===t.status?"工作中":"休息")+"</div>\n                       <div class='info'>时间："+t.data.locatetime+"</div>\n                      </div>",offset:new s.a.Pixel(0,0)}),e.addClickHandler(t,a)}}),d.plugin(["AMap.ToolBar","AMap.MapType"],function(){var e={offset:new s.a.Pixel(100,10),position:"RT",ruler:!0,noIpLocate:!0,locate:!0,liteStyle:!1,direction:!0,autoPosition:!0,locationMarker:s.a.Marker({map:d}),useNative:!1};d.addControl(new s.a.ToolBar(e)),d.addControl(new s.a.MapType({showTraffic:!1,showRoad:!1}))})},getTree:function(e,t){var a=this;Object(i.k)().then(function(t){t.data&&t.data instanceof Array&&(a.treeData=t.data,a.searchFrom.depId=e||a.treeData[0].id,a.searchFrom.depName=a.treeData[0].depName,a.getworkCount(a.searchFrom.depId),a.$nextTick(function(){a.getisDeleteList()}))}).catch(function(e){})},getworkCount:function(e){var t=this;Object(o.g)({depId:e}).then(function(e){t.countDate=e.data})},overlayNodeClick:function(e,t){this.searchFrom.depName=t.data.depName,this.searchFrom.depId=t.data.id,this.getworkCount(t.data.id),this.pageNumber=0,this.getisDeleteList(),this.butlerList=[]},searchbulter:function(){this.pageNumber=0,this.getisDeleteList()},searchIsDeleteList:function(){this.butlerList=[],this.pageNumber=0,this.getisDeleteList()},getisDeleteList:function(){var e=this,t={depId:this.searchFrom.depId,keyword:this.searchFrom.keyword,pageSize:20,pageNo:++this.pageNumber};this.chooseIndex="",Object(o.f)(t).then(function(t){t.data.result&&(e.butlerList=e.butlerList.concat(t.data.result),e.init(),e.$nextTick(function(t){e.loading=!1}))})}}}},"6PD0":function(e,t,a){var i=a("VU/8")(a("43mw"),a("/sDd"),function(e){a("+OQD")},"data-v-5140db6a",null);e.exports=i.exports},Drk7:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".block[data-v-84670a02]{position:absolute;bottom:90px;display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;width:400px;right:40px;border-radius:10px;padding:0 20px;background:#fff;z-index:10}.block .demonstration[data-v-84670a02]{width:40px;text-align:center;line-height:38px;font-size:10px}.block .blockSlide[data-v-84670a02]{-ms-flex:1;flex:1;-webkit-box-flex:1}#map[data-v-84670a02]{height:540px;padding:0;width:100%;background:#fff}.tabItem[data-v-84670a02]{background:#a2a2a2;margin-bottom:15px;color:#fff}.tabItem .top[data-v-84670a02]{padding:0 10px}.active[data-v-84670a02]{background:#1e97fa}.table-box[data-v-84670a02]{border:1px solid #cccfd2;border-radius:4px;padding:4px 10px}.choose-active[data-v-84670a02]{overflow:auto}.table-box[data-v-84670a02]:first-child{padding-bottom:6px}.table-frist[data-v-84670a02]{margin-bottom:10px}.box-data[data-v-84670a02]{padding-bottom:6px}.text-left[data-v-84670a02]{text-align:right}.pad-ri[data-v-84670a02]{padding-right:10px}.container[data-v-84670a02]{padding:20px}.container .alertbox[data-v-84670a02]{background-color:#f0f9eb;color:#67c23a;padding:8px 16px;margin-right:16px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:4px;font-size:13px}.container .tab-Item[data-v-84670a02]{background:#a2a2a2;margin-bottom:15px;color:#fff}.container .tab-Item .top[data-v-84670a02]{padding:0 10px}.container .filter-item[data-v-84670a02]{margin-left:10px}.container .el-form-item[data-v-84670a02]{margin-bottom:0}.container .pageMain[data-v-84670a02]{padding:0 10px}.container .pageMain .centerBanner[data-v-84670a02]{border:1px solid #ccc;border-radius:6px;margin-bottom:4px;padding:10px}.container .pageMain .topBanner[data-v-84670a02]{margin-top:4px;border:1px solid #ccc;border-radius:6px;margin-bottom:6px;padding:20px}.container .pageMain .topBanner .blue[data-v-84670a02]{color:#409eff;font-weight:700;line-height:28px}.leftSidebar[data-v-84670a02]{width:160px;height:100%}",""])},E6tP:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("+MD4"),o=a("Htgu"),n=a("U4Ig"),s=a.n(n),r=a("vqyU"),l=a.n(r),d=a("0xDb"),c=a("+aT9"),p=a.n(c),h=a("mtWM"),m=a.n(h),u=void 0,f=void 0;t.default={computed:{listHeight:function(){return{height:(this.tableHeight-100)/2+"px"}},mapHeight:function(){return{height:this.tableHeight+110+"px"}}},components:{GridUnit:s.a,ScrollLoad:l.a},data:function(){return{lineList:[],lineValue:0,loading:!0,butlerList:[],tableHeight:300,pageNumber:0,chooseIndex:0,chooseCountIndex:0,nowDate:"",searchFrom:{depId:"",isDelete:"null",keyword:"",date:"",managerId:""},IncumbencyList:[{value:"null",label:"全部"},{value:"0",label:"在职"},{value:"1",label:"离职"}],searchList:[],treeData:[],defaultProps:{children:"child",label:"depName"}}},mounted:function(){this.getTree(),this.init()},created:function(){var e=this,t=document.body.clientHeight-320;this.tableHeight=t>300?t:300,window.onresize=function(){return t=document.body.clientHeight-320,void(e.tableHeight=t>300?t:300)};var a=new Date,i=a.getMonth()+1,o=a.getDate();i>=1&&i<=9&&(i="0"+i),o>=0&&o<=9&&(o="0"+o),this.nowDate=a.getFullYear()+"-"+i+"-"+o+" \n            "+a.getHours()+":"+a.getMinutes()+":\n            "+a.getSeconds()},watch:{lineValue:function(e,t){var a=[];a=e>t?this.lineArr.slice(t,e):this.lineArr.slice(e,t).reverse(),f.moveAlong(a,9e4,function(){})}},methods:{handleClick:function(){this.butlerList=[],this.pageNumber=0,this.searchFrom.managerId="",this.getisDeleteList(),this.searchParam()},init:function(){if(this.lineList.length>0){var e=this.lineList[0].location.split(",");u=new p.a.Map("map",{resizeEnable:!0,zoom:12,center:[e[0],e[1]]})}else u=new p.a.Map("map",{resizeEnable:!0,zoom:12});var t=[];this.lineList.length>0&&(t=this.lineList[0].location.split(","),f=new p.a.Marker({map:u,icon:"https://webapi.amap.com/images/car.png",offset:new p.a.Pixel(-26,-13),position:[t[0],t[1]],autoRotation:!0}));var a=this;u.plugin(["AMap.ToolBar","AMap.MapType"],function(){var e={offset:new p.a.Pixel(70,10),position:"RT",ruler:!0,noIpLocate:!1,locate:!0,liteStyle:!1,direction:!0,autoPosition:!(a.lineList.length>0),locationMarker:p.a.Marker({map:u}),useNative:!1};u.addControl(new p.a.ToolBar(e)),u.addControl(new p.a.MapType({showTraffic:!1,showRoad:!1}))})},handleLogin:function(){this.getLineArr()},drawLine:function(){var e=this;this.lineArr=[],this.lineList.map(function(t){var a=t.location.split(",");e.lineArr.push(new p.a.LngLat(a[0],a[1]))}),new p.a.Polyline({map:u,path:this.lineArr,strokeColor:"#fe4a4a",strokeOpacity:1,strokeWeight:3,strokeStyle:"solid"});var t=new p.a.Polyline({map:u,path:this.lineArr,strokeColor:"#000",strokeOpacity:1,strokeWeight:3,strokeStyle:"solid"});f.on("moving",function(e){t.setPath(e.passedPath)}),u.setFitView()},getLineArr:function(){var e={starttime:this.searchList[this.chooseCountIndex].startTime,endtime:this.searchList[this.chooseCountIndex].endTime,page:1,gap:1e3,pagesize:800,tid:this.searchList[this.chooseCountIndex].gdTid,sid:11117,trid:this.searchList[this.chooseCountIndex].trid},t=this;m.a.get("https://tsapi.amap.com/v1/track/terminal/trsearch?key=7bf2aa112f46d78281004b9f678e03f2",{params:e}).then(function(e){e.data.data.tracks&&(t.lineList=e.data.data.tracks[0].points),t.init(),t.drawLine()})},formatTooltip:function(e){if(this.lineList.length>0)return Object(d.d)(this.lineList[e].locatetime)},chooseManagerId:function(e,t){this.chooseCountIndex=t,this.getLineArr()},getworkTrailRecord:function(){var e=this;""!==this.searchFrom.managerId?(this.searchFrom.date=Object(d.e)(this.searchFrom.date),Object(o.h)(this.searchFrom).then(function(t){t.data.length>0&&(e.searchList=t.data,e.getLineArr())})):this.$message({message:"请选择要查看管家",type:"warning"})},nowManagerId:function(e,t){this.searchFrom.date=this.nowDate,this.searchList=[],this.chooseIndex=t,this.searchFrom.managerId=e.id,this.getworkTrailRecord()},searchIsDeleteList:function(){this.butlerList=[],this.pageNumber=0,this.getisDeleteList()},getisDeleteList:function(){var e=this,t={depId:this.searchFrom.depId,keyword:this.searchFrom.keyword,isDelete:this.searchFrom.isDelete,pageSize:20,pageNo:++this.pageNumber};this.chooseIndex="",Object(o.c)(t).then(function(t){t.data.result&&(e.butlerList=e.butlerList.concat(t.data.result))})},overlayNodeClick:function(e,t){this.searchFrom.depName=t.data.depName,this.searchFrom.depId=t.data.id,this.pageNumber=0,this.getisDeleteList(),this.butlerList=[]},getTree:function(e,t){var a=this;Object(i.k)().then(function(t){t.data&&t.data instanceof Array&&(a.treeData=t.data,a.searchFrom.depId=e||a.treeData[0].id,a.searchFrom.depName=a.treeData[0].depName,a.$nextTick(function(){a.getisDeleteList()}))}).catch(function(e){})}}}},LKJ5:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".pageMain[data-v-5140db6a]{margin:-20px 0;position:relative}.showbox[data-v-5140db6a]{position:absolute;width:160px;top:40px;background:#fff;height:30px;z-index:10;padding:0 10px;font-size:12px;border-radius:4px;-webkit-box-shadow:1px 1px 4px #123;box-shadow:1px 1px 4px #123;color:#757677;line-height:30px;left:30px}#map[data-v-5140db6a]{padding:0;width:100%;background:#fff}.el-form-item[data-v-5140db6a]{margin-bottom:0}.table-box[data-v-5140db6a]{padding-top:10px}.content-amap[data-v-5140db6a]{background:#123}",""])},MCdq:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-tabs",{attrs:{type:"border-card"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[a("el-tab-pane",{attrs:{label:"实时位置",name:"1"}},["1"===e.type?a("nowBehaviorPosition"):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:"工作轨迹",name:"0"}},["0"===e.type?a("WorkTrailRecord"):e._e()],1)],1)],1)},staticRenderFns:[]}},MbiU:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-container",[a("el-aside",{staticClass:"leftSidebar",attrs:{width:"260px"}},[a("el-form",[a("el-form-item",[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.searchFrom.depName,callback:function(t){e.$set(e.searchFrom,"depName",t)},expression:"searchFrom.depName"}},[a("el-tree",{ref:"overlayTree",attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","highlight-current":!0,"expand-on-click-node":!1},on:{"node-click":e.overlayNodeClick}}),e._v(" "),a("el-option",{staticStyle:{display:"none"},attrs:{value:""}})],1)],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{size:"small",placeholder:"业务员姓名/手机号码"},on:{input:e.searchIsDeleteList},model:{value:e.searchFrom.keyword,callback:function(t){e.$set(e.searchFrom,"keyword",t)},expression:"searchFrom.keyword"}})],1),e._v(" "),a("el-form-item",[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.searchFrom.isDelete,callback:function(t){e.$set(e.searchFrom,"isDelete",t)},expression:"searchFrom.isDelete"}},e._l(e.IncumbencyList,function(e,t){return a("el-tab-pane",{key:t,attrs:{label:e.label,name:e.value}})}))],1),e._v(" "),a("el-form-item",[a("div",{staticClass:"table-box table-frist"},[a("scrollLoad",{attrs:{listHeight:e.listHeight,butlerList:e.butlerList,chooseIndex:e.chooseIndex,getBulter:e.getisDeleteList},on:{getManagerId:e.nowManagerId}})],1)]),e._v(" "),a("el-form-item",[a("div",{staticClass:"table-box"},[a("div",{staticClass:"box-data"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",size:"small",placeholder:"选择日期"},on:{change:e.getworkTrailRecord},model:{value:e.searchFrom.date,callback:function(t){e.$set(e.searchFrom,"date",t)},expression:"searchFrom.date"}})],1),e._v(" "),a("div",{staticClass:"choose-active",style:e.listHeight},e._l(e.searchList,function(t,i){return e.searchList.length>0?a("div",{key:i,staticClass:"tabItem",class:{active:e.chooseCountIndex===i},on:{click:function(a){e.chooseManagerId(t,i)}}},[a("el-row",{staticClass:"top"},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"mobile"},[e._v("轨迹"+e._s(i+1))])]),e._v(" "),a("el-col",{attrs:{span:18}},[a("span",{staticClass:"mobile"},[e._v(e._s(t.start)+"-"+e._s(t.end))])])],1)],1):a("div",{staticClass:"tab-Item"},[e._v("\n                   暂无数据～～\n                 ")])}))])])],1)],1),e._v(" "),a("el-main",{staticClass:"pageMain"},[a("div",{style:e.mapHeight,attrs:{id:"map"}}),e._v(" "),a("div",{staticClass:"block"},[a("span",{staticClass:"demonstration"},[e._v("开始")]),e._v(" "),a("el-slider",{staticClass:"blockSlide",attrs:{max:e.lineList.length,"format-tooltip":e.formatTooltip},model:{value:e.lineValue,callback:function(t){e.lineValue=t},expression:"lineValue"}}),e._v(" "),a("span",{staticClass:"demonstration"},[e._v("结束")])],1)])],1)],1)},staticRenderFns:[]}},WjIg:function(e,t,a){var i=a("VU/8")(a("E6tP"),a("MbiU"),function(e){a("oVxH")},"data-v-84670a02",null);e.exports=i.exports},c0jm:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("6PD0"),o=a.n(i),n=a("WjIg"),s=a.n(n);t.default={components:{NowBehaviorPosition:o.a,WorkTrailRecord:s.a},data:function(){return{type:"1"}},mounted:function(){},created:function(){},methods:{}}},oVxH:function(e,t,a){var i=a("Drk7");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("2650ad4a",i,!0)},vLC2:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".container[data-v-0244a41c]{padding:20px}.el-form-item[data-v-0244a41c]{margin-bottom:0}",""])},wiNo:function(e,t,a){var i=a("VU/8")(a("c0jm"),a("MCdq"),function(e){a("wq4t")},"data-v-0244a41c",null);e.exports=i.exports},wq4t:function(e,t,a){var i=a("vLC2");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("8c8ec672",i,!0)}});